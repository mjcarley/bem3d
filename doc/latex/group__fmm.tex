\section{Fast Multipole Method}
\label{group__fmm}\index{Fast Multipole Method@{Fast Multipole Method}}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \+\_\+\+B\+E\+M3\+D\+F\+M\+M\+Matrix \textbf{ B\+E\+M3\+D\+F\+M\+M\+Matrix}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ B\+E\+M3\+D\+Fast\+Multipole} \{ \textbf{ B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2} = 1
 \}
\item 
enum \textbf{ B\+E\+M3\+D\+Fast\+Multipole\+Problem} \{ \textbf{ B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+CE}, 
\textbf{ B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+TZ}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ B\+E\+M3\+D\+F\+M\+M\+Matrix} $\ast$ \textbf{ bem3d\+\_\+fmm\+\_\+matrix\+\_\+new} (\textbf{ B\+E\+M3\+D\+Fast\+Multipole} solver, \textbf{ B\+E\+M3\+D\+Fast\+Multipole\+Problem} problem, \textbf{ B\+E\+M3\+D\+Mesh\+Skeleton} $\ast$skel, \textbf{ B\+E\+M3\+D\+Configuration} $\ast$config, \textbf{ B\+E\+M3\+D\+Parameters} $\ast$param, gdouble r)
\item 
gchar $\ast$ \textbf{ bem3d\+\_\+solver\+\_\+name} (\textbf{ B\+E\+M3\+D\+Solver} s)
\item 
\textbf{ B\+E\+M3\+D\+Solver} \textbf{ bem3d\+\_\+solver\+\_\+type} (gchar $\ast$s)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The Fast Multipole Method (F\+MM) is a standard technique for accelerating B\+EM calculations. B\+E\+M3D includes an interface to F\+MM solvers developed by other groups, identified by \doxyref{B\+E\+M3\+D\+Fast\+Multipole}{p.}{group__fmm_gab908afe0c8ff3880fd8e79ea00234aff} 

\subsection{Typedef Documentation}
\mbox{\label{group__fmm_ga0d3f5d1d046406e6bc84693f0d5116f3}} 
\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+F\+M\+M\+Matrix@{B\+E\+M3\+D\+F\+M\+M\+Matrix}}
\index{B\+E\+M3\+D\+F\+M\+M\+Matrix@{B\+E\+M3\+D\+F\+M\+M\+Matrix}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection{B\+E\+M3\+D\+F\+M\+M\+Matrix}
{\footnotesize\ttfamily typedef struct \+\_\+\+B\+E\+M3\+D\+F\+M\+M\+Matrix \textbf{ B\+E\+M3\+D\+F\+M\+M\+Matrix}}

A (non-\/) matrix type for using Fast Multipole Method summations in solvers. 

\subsection{Enumeration Type Documentation}
\mbox{\label{group__fmm_gab908afe0c8ff3880fd8e79ea00234aff}} 
\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+Fast\+Multipole@{B\+E\+M3\+D\+Fast\+Multipole}}
\index{B\+E\+M3\+D\+Fast\+Multipole@{B\+E\+M3\+D\+Fast\+Multipole}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection{B\+E\+M3\+D\+Fast\+Multipole}
{\footnotesize\ttfamily enum \textbf{ B\+E\+M3\+D\+Fast\+Multipole}}

Selection of different fast multipole implementations linked into the library \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2}!Fast Multipole Method@{Fast Multipole Method}}\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2}}}\mbox{\label{group__fmm_ggab908afe0c8ff3880fd8e79ea00234affa8cd3840463a235efa62e065afa81b387}} 
B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2&fmmlib3d-\/1.\+2, {\tt https\+://github.\+com/zgimbutas/fmmlib3d} \\
\hline

\end{DoxyEnumFields}
\mbox{\label{group__fmm_gaa6f3e73f1e19d3277c8ee633e869d647}} 
\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+Fast\+Multipole\+Problem@{B\+E\+M3\+D\+Fast\+Multipole\+Problem}}
\index{B\+E\+M3\+D\+Fast\+Multipole\+Problem@{B\+E\+M3\+D\+Fast\+Multipole\+Problem}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection{B\+E\+M3\+D\+Fast\+Multipole\+Problem}
{\footnotesize\ttfamily enum \textbf{ B\+E\+M3\+D\+Fast\+Multipole\+Problem}}

Selection of problem type for fast multipole calculation. Not all F\+MM solvers will be able to solve all problems. \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+CE@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+CE}!Fast Multipole Method@{Fast Multipole Method}}\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+CE@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+CE}}}\mbox{\label{group__fmm_ggaa6f3e73f1e19d3277c8ee633e869d647ac3938c2c26280542a8f9aa7b5a4bcce8}} 
B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+CE&Laplace equation \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+TZ@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+TZ}!Fast Multipole Method@{Fast Multipole Method}}\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+TZ@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+TZ}}}\mbox{\label{group__fmm_ggaa6f3e73f1e19d3277c8ee633e869d647aa55f056e8f8d3c3a6d4d6c04670f47fa}} 
B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+TZ&Helmholtz equation \\
\hline

\end{DoxyEnumFields}


\subsection{Function Documentation}
\mbox{\label{group__fmm_ga539d1105d7fedc93ea5bfdfc4eb14b00}} 
\index{Fast Multipole Method@{Fast Multipole Method}!bem3d\+\_\+fmm\+\_\+matrix\+\_\+new@{bem3d\+\_\+fmm\+\_\+matrix\+\_\+new}}
\index{bem3d\+\_\+fmm\+\_\+matrix\+\_\+new@{bem3d\+\_\+fmm\+\_\+matrix\+\_\+new}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection{bem3d\+\_\+fmm\+\_\+matrix\+\_\+new()}
{\footnotesize\ttfamily \textbf{ B\+E\+M3\+D\+F\+M\+M\+Matrix}$\ast$ bem3d\+\_\+fmm\+\_\+matrix\+\_\+new (\begin{DoxyParamCaption}\item[{\textbf{ B\+E\+M3\+D\+Fast\+Multipole}}]{solver,  }\item[{\textbf{ B\+E\+M3\+D\+Fast\+Multipole\+Problem}}]{problem,  }\item[{\textbf{ B\+E\+M3\+D\+Mesh\+Skeleton} $\ast$}]{skel,  }\item[{\textbf{ B\+E\+M3\+D\+Configuration} $\ast$}]{config,  }\item[{\textbf{ B\+E\+M3\+D\+Parameters} $\ast$}]{param,  }\item[{gdouble}]{r }\end{DoxyParamCaption})}

Generate a new \doxyref{B\+E\+M3\+D\+F\+M\+M\+Matrix}{p.}{group__fmm_ga0d3f5d1d046406e6bc84693f0d5116f3} which can be used in matrix-\/free calculations. The underlying calculation method uses a set of point sources to represent the mesh, in {\itshape skel}. This is then `corrected' by subtracting sources which lie within distance {\itshape r} of a collocation point and adding the integrated contribution from those elements calculated using the quadrature rules set in the configuration {\itshape config}.


\begin{DoxyParams}{Parameters}
{\em solver} & the F\+MM solver to be used; \\
\hline
{\em problem} & problem to be solved by F\+MM solver (e.\+g. Helmholtz or Laplace) \\
\hline
{\em skel} & a \doxyref{B\+E\+M3\+D\+Mesh\+Skeleton}{p.}{structBEM3DMeshSkeleton} for the source points which will be passed to the F\+MM solver; \\
\hline
{\em config} & configuration for the problem (including quadrature rules for correction calculation); \\
\hline
{\em param} & parameters for the physics; \\
\hline
{\em r} & radius for elements to included in correction calculation.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+E\+M3\+D\+\_\+\+S\+U\+C\+C\+E\+SS on success. 
\end{DoxyReturn}


References bem3d\+\_\+mesh\+\_\+foreach\+\_\+node().

\mbox{\label{group__fmm_ga2642f97835ada43a952e039746187850}} 
\index{Fast Multipole Method@{Fast Multipole Method}!bem3d\+\_\+solver\+\_\+name@{bem3d\+\_\+solver\+\_\+name}}
\index{bem3d\+\_\+solver\+\_\+name@{bem3d\+\_\+solver\+\_\+name}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection{bem3d\+\_\+solver\+\_\+name()}
{\footnotesize\ttfamily gchar$\ast$ bem3d\+\_\+solver\+\_\+name (\begin{DoxyParamCaption}\item[{\textbf{ B\+E\+M3\+D\+Solver}}]{s }\end{DoxyParamCaption})}

Return a string giving a name to a \doxyref{B\+E\+M3\+D\+Solver}{p.}{group__config_ga795c07626d3e4c4e2fe832a3fa32a161}


\begin{DoxyParams}{Parameters}
{\em s} & a solver type\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a string containing a human-\/readable name for {\itshape s} 
\end{DoxyReturn}
\mbox{\label{group__fmm_ga602a453cd81707fd71c61fa08a0f671a}} 
\index{Fast Multipole Method@{Fast Multipole Method}!bem3d\+\_\+solver\+\_\+type@{bem3d\+\_\+solver\+\_\+type}}
\index{bem3d\+\_\+solver\+\_\+type@{bem3d\+\_\+solver\+\_\+type}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection{bem3d\+\_\+solver\+\_\+type()}
{\footnotesize\ttfamily \textbf{ B\+E\+M3\+D\+Solver} bem3d\+\_\+solver\+\_\+type (\begin{DoxyParamCaption}\item[{gchar $\ast$}]{s }\end{DoxyParamCaption})}

Inverse of \doxyref{bem3d\+\_\+solver\+\_\+name}{p.}{group__fmm_ga2642f97835ada43a952e039746187850}, given a human-\/readable name for a solver, return the corresponding \doxyref{B\+E\+M3\+D\+Solver}{p.}{group__config_ga795c07626d3e4c4e2fe832a3fa32a161}


\begin{DoxyParams}{Parameters}
{\em s} & a string containing a solver name returned by \doxyref{bem3d\+\_\+solver\+\_\+name}{p.}{group__fmm_ga2642f97835ada43a952e039746187850}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the \doxyref{B\+E\+M3\+D\+Solver}{p.}{group__config_ga795c07626d3e4c4e2fe832a3fa32a161} corresponding to {\itshape s} 
\end{DoxyReturn}
