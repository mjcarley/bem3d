\section{Fast Multipole Method}
\label{group__fmm}\index{Fast Multipole Method@{Fast Multipole Method}}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \+\_\+\+B\+E\+M3\+D\+F\+M\+M\+Matrix {\bf B\+E\+M3\+D\+F\+M\+M\+Matrix}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum {\bf B\+E\+M3\+D\+Fast\+Multipole} \{ {\bf B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2} = 1, 
{\bf B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+W\+B\+F\+M\+M} = 2
 \}
\item 
enum {\bf B\+E\+M3\+D\+Fast\+Multipole\+Problem} \{ {\bf B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E}, 
{\bf B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
gint {\bf bem3d\+\_\+fmm\+\_\+calculate} ({\bf B\+E\+M3\+D\+Fast\+Multipole} solver, {\bf B\+E\+M3\+D\+Fast\+Multipole\+Problem} problem, {\bf B\+E\+M3\+D\+Parameters} $\ast$param, {\bf B\+E\+M3\+D\+Mesh\+Skeleton} $\ast$s, gdouble tol, gdouble $\ast$q, gdouble $\ast$dq, gdouble $\ast$p, gdouble $\ast$dp, B\+E\+M3\+D\+F\+M\+M\+Workspace $\ast$w)
\item 
B\+E\+M3\+D\+F\+M\+M\+Workspace $\ast$ {\bf bem3d\+\_\+fmm\+\_\+workspace\+\_\+alloc} ({\bf B\+E\+M3\+D\+Fast\+Multipole} solver, {\bf B\+E\+M3\+D\+Mesh\+Skeleton} $\ast$skel)
\item 
{\bf B\+E\+M3\+D\+F\+M\+M\+Matrix} $\ast$ {\bf bem3d\+\_\+fmm\+\_\+matrix\+\_\+new} ({\bf B\+E\+M3\+D\+Fast\+Multipole} solver, {\bf B\+E\+M3\+D\+Fast\+Multipole\+Problem} problem, {\bf B\+E\+M3\+D\+Mesh\+Skeleton} $\ast$skel, {\bf B\+E\+M3\+D\+Configuration} $\ast$config, {\bf B\+E\+M3\+D\+Parameters} $\ast$param, gdouble r, {\bf B\+E\+M3\+D\+Workspace} $\ast$work)
\item 
gchar $\ast$ {\bf bem3d\+\_\+solver\+\_\+name} ({\bf B\+E\+M3\+D\+Solver} s)
\item 
{\bf B\+E\+M3\+D\+Solver} {\bf bem3d\+\_\+solver\+\_\+type} (gchar $\ast$s)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The Fast Multipole Method (F\+M\+M) is a standard technique for accelerating B\+E\+M calculations. B\+E\+M3\+D includes an interface to F\+M\+M solvers developed by other groups, identified by \doxyref{B\+E\+M3\+D\+Fast\+Multipole}{p.}{group__fmm_gab908afe0c8ff3880fd8e79ea00234aff} 

\subsection{Typedef Documentation}
\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+F\+M\+M\+Matrix@{B\+E\+M3\+D\+F\+M\+M\+Matrix}}
\index{B\+E\+M3\+D\+F\+M\+M\+Matrix@{B\+E\+M3\+D\+F\+M\+M\+Matrix}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection[{B\+E\+M3\+D\+F\+M\+M\+Matrix}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct \+\_\+\+B\+E\+M3\+D\+F\+M\+M\+Matrix {\bf B\+E\+M3\+D\+F\+M\+M\+Matrix}}\label{group__fmm_ga0d3f5d1d046406e6bc84693f0d5116f3}
A (non-\/) matrix type for using Fast Multipole Method summations in solvers. 

\subsection{Enumeration Type Documentation}
\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+Fast\+Multipole@{B\+E\+M3\+D\+Fast\+Multipole}}
\index{B\+E\+M3\+D\+Fast\+Multipole@{B\+E\+M3\+D\+Fast\+Multipole}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection[{B\+E\+M3\+D\+Fast\+Multipole}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf B\+E\+M3\+D\+Fast\+Multipole}}\label{group__fmm_gab908afe0c8ff3880fd8e79ea00234aff}
Selection of different fast multipole implementations linked into the library \begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2}!Fast Multipole Method@{Fast Multipole Method}}\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2}}\item[{\em 
B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2\label{group__fmm_ggab908afe0c8ff3880fd8e79ea00234affa8cd3840463a235efa62e065afa81b387}
}]fmmlib3d-\/1.\+2, {\tt https\+://github.\+com/zgimbutas/fmmlib3d} \index{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+W\+B\+F\+M\+M@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+W\+B\+F\+M\+M}!Fast Multipole Method@{Fast Multipole Method}}\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+W\+B\+F\+M\+M@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+W\+B\+F\+M\+M}}\item[{\em 
B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+W\+B\+F\+M\+M\label{group__fmm_ggab908afe0c8ff3880fd8e79ea00234affa0377f6dd5a4ce5a5e6d08ba46ca37757}
}]wbfmm, {\tt https\+://github.\+com/mjcarley/wbfmm} \end{description}
\end{Desc}
\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+Fast\+Multipole\+Problem@{B\+E\+M3\+D\+Fast\+Multipole\+Problem}}
\index{B\+E\+M3\+D\+Fast\+Multipole\+Problem@{B\+E\+M3\+D\+Fast\+Multipole\+Problem}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection[{B\+E\+M3\+D\+Fast\+Multipole\+Problem}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf B\+E\+M3\+D\+Fast\+Multipole\+Problem}}\label{group__fmm_gaa6f3e73f1e19d3277c8ee633e869d647}
Selection of problem type for fast multipole calculation. Not all F\+M\+M solvers will be able to solve all problems. \begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E}!Fast Multipole Method@{Fast Multipole Method}}\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E}}\item[{\em 
B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E\label{group__fmm_ggaa6f3e73f1e19d3277c8ee633e869d647ac3938c2c26280542a8f9aa7b5a4bcce8}
}]Laplace equation \index{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z}!Fast Multipole Method@{Fast Multipole Method}}\index{Fast Multipole Method@{Fast Multipole Method}!B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z@{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z}}\item[{\em 
B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z\label{group__fmm_ggaa6f3e73f1e19d3277c8ee633e869d647aa55f056e8f8d3c3a6d4d6c04670f47fa}
}]Helmholtz equation \end{description}
\end{Desc}


\subsection{Function Documentation}
\index{Fast Multipole Method@{Fast Multipole Method}!bem3d\+\_\+fmm\+\_\+calculate@{bem3d\+\_\+fmm\+\_\+calculate}}
\index{bem3d\+\_\+fmm\+\_\+calculate@{bem3d\+\_\+fmm\+\_\+calculate}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection[{bem3d\+\_\+fmm\+\_\+calculate}]{\setlength{\rightskip}{0pt plus 5cm}gint bem3d\+\_\+fmm\+\_\+calculate (
\begin{DoxyParamCaption}
\item[{{\bf B\+E\+M3\+D\+Fast\+Multipole}}]{solver, }
\item[{{\bf B\+E\+M3\+D\+Fast\+Multipole\+Problem}}]{problem, }
\item[{{\bf B\+E\+M3\+D\+Parameters} $\ast$}]{param, }
\item[{{\bf B\+E\+M3\+D\+Mesh\+Skeleton} $\ast$}]{s, }
\item[{gdouble}]{tol, }
\item[{gdouble $\ast$}]{q, }
\item[{gdouble $\ast$}]{dq, }
\item[{gdouble $\ast$}]{p, }
\item[{gdouble $\ast$}]{dp, }
\item[{B\+E\+M3\+D\+F\+M\+M\+Workspace $\ast$}]{w}
\end{DoxyParamCaption}
)}\label{group__fmm_gaa6af338ee603160ea484e5485a0d61c1}
Perform a Fast Multipole Method (F\+M\+M) calculation using a specified solver.


\begin{DoxyParams}{Parameters}
{\em solver} & a \doxyref{B\+E\+M3\+D\+Fast\+Multipole}{p.}{group__fmm_gab908afe0c8ff3880fd8e79ea00234aff} solver (depending on what has been compiled in to the library); \\
\hline
{\em problem} & type of problem to be solved, for example, \doxyref{B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E}{p.}{group__fmm_ggaa6f3e73f1e19d3277c8ee633e869d647ac3938c2c26280542a8f9aa7b5a4bcce8}, not all {\itshape solver} types can solve all problem types; \\
\hline
{\em param} & parameters for the problem; \\
\hline
{\em s} & an initialized \doxyref{B\+E\+M3\+D\+Mesh\+Skeleton}{p.}{structBEM3DMeshSkeleton} containing the point sources to be used in the F\+M\+M evaluation; \\
\hline
{\em tol} & F\+M\+M evaluation tolerance; \\
\hline
{\em q} & packed array of source strengths for the points in {\itshape s}; \\
\hline
{\em dq} & packed array of dipole strengths for the points in {\itshape s}; \\
\hline
{\em p} & on output, potential evaluated at target points in {\itshape s}; \\
\hline
{\em dp} & on output, normal derivative of potential evaluated at target points in {\itshape s}; \\
\hline
{\em w} & a \+::\+B\+E\+M3\+D\+F\+M\+M\+Workspace allocated using \doxyref{bem3d\+\_\+fmm\+\_\+workspace\+\_\+alloc}{p.}{group__fmm_ga77f6060bed81a8414a3620ffb71db64f};\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}


References B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2, B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z, B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E, and B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+W\+B\+F\+M\+M.

\index{Fast Multipole Method@{Fast Multipole Method}!bem3d\+\_\+fmm\+\_\+matrix\+\_\+new@{bem3d\+\_\+fmm\+\_\+matrix\+\_\+new}}
\index{bem3d\+\_\+fmm\+\_\+matrix\+\_\+new@{bem3d\+\_\+fmm\+\_\+matrix\+\_\+new}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection[{bem3d\+\_\+fmm\+\_\+matrix\+\_\+new}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\+E\+M3\+D\+F\+M\+M\+Matrix}$\ast$ bem3d\+\_\+fmm\+\_\+matrix\+\_\+new (
\begin{DoxyParamCaption}
\item[{{\bf B\+E\+M3\+D\+Fast\+Multipole}}]{solver, }
\item[{{\bf B\+E\+M3\+D\+Fast\+Multipole\+Problem}}]{problem, }
\item[{{\bf B\+E\+M3\+D\+Mesh\+Skeleton} $\ast$}]{skel, }
\item[{{\bf B\+E\+M3\+D\+Configuration} $\ast$}]{config, }
\item[{{\bf B\+E\+M3\+D\+Parameters} $\ast$}]{param, }
\item[{gdouble}]{r, }
\item[{{\bf B\+E\+M3\+D\+Workspace} $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__fmm_ga253eb3cb80ff73e902f653f325412420}
Generate a new \doxyref{B\+E\+M3\+D\+F\+M\+M\+Matrix}{p.}{group__fmm_ga0d3f5d1d046406e6bc84693f0d5116f3} which can be used in matrix-\/free calculations. The underlying calculation method uses a set of point sources to represent the mesh, in {\itshape skel}. This is then `corrected\textquotesingle{} by subtracting sources which lie within distance {\itshape r} of a collocation point and adding the integrated contribution from those elements calculated using the quadrature rules set in the configuration {\itshape config}.


\begin{DoxyParams}{Parameters}
{\em solver} & the F\+M\+M solver to be used; \\
\hline
{\em problem} & problem to be solved by F\+M\+M solver (e.\+g. Helmholtz or Laplace) \\
\hline
{\em skel} & a \doxyref{B\+E\+M3\+D\+Mesh\+Skeleton}{p.}{structBEM3DMeshSkeleton} for the source points which will be passed to the F\+M\+M solver; \\
\hline
{\em config} & configuration for the problem (including quadrature rules for correction calculation); \\
\hline
{\em param} & parameters for the physics; \\
\hline
{\em r} & radius for elements to included in correction calculation; \\
\hline
{\em work} & a \doxyref{B\+E\+M3\+D\+Workspace}{p.}{group__work_gaf540948fbe875dff930ad182734d5dbb}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+E\+M3\+D\+\_\+\+S\+U\+C\+C\+E\+S\+S on success. 
\end{DoxyReturn}


References bem3d\+\_\+mesh\+\_\+foreach\+\_\+node().

\index{Fast Multipole Method@{Fast Multipole Method}!bem3d\+\_\+fmm\+\_\+workspace\+\_\+alloc@{bem3d\+\_\+fmm\+\_\+workspace\+\_\+alloc}}
\index{bem3d\+\_\+fmm\+\_\+workspace\+\_\+alloc@{bem3d\+\_\+fmm\+\_\+workspace\+\_\+alloc}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection[{bem3d\+\_\+fmm\+\_\+workspace\+\_\+alloc}]{\setlength{\rightskip}{0pt plus 5cm}B\+E\+M3\+D\+F\+M\+M\+Workspace$\ast$ bem3d\+\_\+fmm\+\_\+workspace\+\_\+alloc (
\begin{DoxyParamCaption}
\item[{{\bf B\+E\+M3\+D\+Fast\+Multipole}}]{solver, }
\item[{{\bf B\+E\+M3\+D\+Mesh\+Skeleton} $\ast$}]{skel}
\end{DoxyParamCaption}
)}\label{group__fmm_ga77f6060bed81a8414a3620ffb71db64f}
Allocate a \+::\+B\+E\+M3\+D\+F\+M\+M\+Workspace for use in Fast Multipole Method evaluations.


\begin{DoxyParams}{Parameters}
{\em solver} & a \doxyref{B\+E\+M3\+D\+Fast\+Multipole}{p.}{group__fmm_gab908afe0c8ff3880fd8e79ea00234aff} specifying the F\+M\+M method to be used; \\
\hline
{\em skel} & the \doxyref{B\+E\+M3\+D\+Mesh\+Skeleton}{p.}{structBEM3DMeshSkeleton} which is to be passed to the solver;\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the newly allocated \+::\+B\+E\+M3\+D\+F\+M\+M\+Workspace. 
\end{DoxyReturn}


References B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+F\+M\+M\+L\+I\+B3\+D\+\_\+1\+\_\+2, and B\+E\+M3\+D\+\_\+\+F\+M\+M\+\_\+\+W\+B\+F\+M\+M.

\index{Fast Multipole Method@{Fast Multipole Method}!bem3d\+\_\+solver\+\_\+name@{bem3d\+\_\+solver\+\_\+name}}
\index{bem3d\+\_\+solver\+\_\+name@{bem3d\+\_\+solver\+\_\+name}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection[{bem3d\+\_\+solver\+\_\+name}]{\setlength{\rightskip}{0pt plus 5cm}gchar$\ast$ bem3d\+\_\+solver\+\_\+name (
\begin{DoxyParamCaption}
\item[{{\bf B\+E\+M3\+D\+Solver}}]{s}
\end{DoxyParamCaption}
)}\label{group__fmm_ga2642f97835ada43a952e039746187850}
Return a string giving a name to a \doxyref{B\+E\+M3\+D\+Solver}{p.}{group__config_ga795c07626d3e4c4e2fe832a3fa32a161}


\begin{DoxyParams}{Parameters}
{\em s} & a solver type\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a string containing a human-\/readable name for {\itshape s} 
\end{DoxyReturn}
\index{Fast Multipole Method@{Fast Multipole Method}!bem3d\+\_\+solver\+\_\+type@{bem3d\+\_\+solver\+\_\+type}}
\index{bem3d\+\_\+solver\+\_\+type@{bem3d\+\_\+solver\+\_\+type}!Fast Multipole Method@{Fast Multipole Method}}
\subsubsection[{bem3d\+\_\+solver\+\_\+type}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\+E\+M3\+D\+Solver} bem3d\+\_\+solver\+\_\+type (
\begin{DoxyParamCaption}
\item[{gchar $\ast$}]{s}
\end{DoxyParamCaption}
)}\label{group__fmm_ga602a453cd81707fd71c61fa08a0f671a}
Inverse of \doxyref{bem3d\+\_\+solver\+\_\+name}{p.}{group__fmm_ga2642f97835ada43a952e039746187850}, given a human-\/readable name for a solver, return the corresponding \doxyref{B\+E\+M3\+D\+Solver}{p.}{group__config_ga795c07626d3e4c4e2fe832a3fa32a161}


\begin{DoxyParams}{Parameters}
{\em s} & a string containing a solver name returned by \doxyref{bem3d\+\_\+solver\+\_\+name}{p.}{group__fmm_ga2642f97835ada43a952e039746187850}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the \doxyref{B\+E\+M3\+D\+Solver}{p.}{group__config_ga795c07626d3e4c4e2fe832a3fa32a161} corresponding to {\itshape s} 
\end{DoxyReturn}
